"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),a=e(t),l=e(require("lodash.clonedeep")),n=e(require("lodash.set")),r=e(require("lodash.result")),u=require("react-use-pointer-drag"),c=require("react-color"),i=t.createContext(void 0);function s(e,a,l){var n=t.useContext(i);return[t.useMemo((function(){var t;return null!=(t=null==n?void 0:n.getValue(e))?t:a}),[n,e,a]),t.useCallback((function(t){e&&n&&n.setValue(e,t),null==l||l(e,t)}),[e,n,l])]}var o=function(e){var t=e.label,l=e.children;return a.createElement("div",{className:"react-var-ui-label "+(t?"react-var-ui-label-has-label ":"react-var-ui-label-no-label ")+(e.disabled?"react-var-ui-disabled ":"")+(e.className||"")},!!t&&a.createElement("span",null,t),l)},m=2*Math.PI;function v(e){return(m+e%m)%m}function d(e,t,a,l,n){isFinite(e)||(e=null!=t?t:0);var r,u=2;return"number"==typeof l&&((u=(null==(r=l.toString().split(".")[1])?void 0:r.length)||0)>20&&(u=20),e=Math.round(e/l)*l),"number"==typeof t&&(e=Math.max(t,e)),"number"==typeof a&&(e=Math.min(a,e)),n?Math.round(e):parseFloat(e.toFixed(u))}var f=function(){return a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},a.createElement("path",{fillRule:"evenodd",d:"M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"}))},p=function(){return a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"},a.createElement("path",{fillRule:"evenodd",d:"M7.646 4.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 5.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z"}))};function g(e,t,a,l){var n=[0,0];if(!e||!Array.isArray(e)||e.length<2)return n;for(var r=0;r<l.length;r++){var u,c=(null==(u=l[r].toString().split(".")[1])?void 0:u.length)||0;n[r]=Math.round(e[r]/l[r])*l[r],n[r]=Math.max(t[r],n[r]),n[r]=Math.min(a[r],n[r]),n[r]=parseFloat(n[r].toFixed(c))}return n}var h=function(){return a.createElement("svg",{width:"34",height:"36",viewBox:"0 0 34 36",fill:"none",xmlns:"http://www.w3.org/2000/svg"},a.createElement("rect",{x:"0.5",y:"2.5",width:"33",height:"33",rx:"5.5",stroke:"#515151"}),a.createElement("path",{d:"M16.456 13.736V18.968H11.2V20.6H16.456V25.856H18.088V20.6H23.32V18.968H18.088V13.736H16.456Z",fill:"#515151"}))};exports.VarAngle=function(e){var l=e.label,n=e.path,r=e.value,c=e.onChange,i=e.disabled,m=e.defaultValue,d=void 0===m?0:m,f=e.className,p=t.useRef(null),g=s(n,r,c),h=g[0],b=g[1],E=t.useMemo((function(){return Math.round(v(h)*(180/Math.PI))}),[h]),N=t.useCallback((function(e,t){if(p.current){var a=p.current.getBoundingClientRect();b(v(Math.atan2(t-(a.top+a.height/2),e-(a.left+a.width/2))+Math.PI/2))}}),[b]),C=u.usePointerDragSimple(N).events;return t.useEffect((function(){var e;null==(e=p.current)||e.addEventListener("wheel",(function(e){return e.preventDefault()}))}),[]),a.createElement(o,{label:l,disabled:i,className:f},a.createElement("span",{className:"react-var-ui-angle-value"},E,"°"),a.createElement("div",{className:"react-var-ui-angle"},a.createElement("div",Object.assign({className:"react-var-ui-angle-control",ref:p,style:{transform:"rotate("+E+"deg)"},onDoubleClick:function(){return void 0!==d&&b(d)},onWheel:function(e){b(v(h+.5*(e.deltaY<0?-1:1)))},title:"Angle"},C))))},exports.VarBase=o,exports.VarButton=function(e){var t=e.onClick,l=e.disabled;return a.createElement(o,{label:e.label,disabled:l,className:e.className},a.createElement("span",{className:"react-var-ui-button"},a.createElement("button",{onClick:function(){return null==t?void 0:t()},disabled:l},e.buttonLabel)))},exports.VarCategory=function(e){var t=e.children;return a.createElement("div",{className:"react-var-ui-category "+(e.className||"")},a.createElement("div",{className:"react-var-ui-category-title"},e.label),!!t&&a.createElement("div",null,t))},exports.VarColor=function(e){var l=e.label,n=e.alpha,r=e.disabled,u=e.className,i=s(e.path,e.value,e.onChange),m=i[0],v=i[1],d=t.useState(!1),f=d[0],p=d[1],g=t.useCallback((function(){return p((function(e){return!e}))}),[p]),h=t.useCallback((function(){return p(!1)}),[p]);return a.createElement(o,{label:l,disabled:r,className:u},a.createElement("span",null,a.createElement("span",{className:"react-var-ui-color-value"},m),a.createElement("div",{className:"react-var-ui-color"},a.createElement("div",{className:"react-var-ui-color-swatch",onClick:g},a.createElement("div",{className:"react-var-ui-color-color",title:"Color preview",style:{background:m}})),f?a.createElement("div",{className:"react-var-ui-color-popover"},a.createElement("div",{className:"react-var-ui-color-cover",onClick:h}),a.createElement(c.SketchPicker,{color:m,onChange:function(e){if(n){var t,a=Math.round(255*(null!=(t=e.rgb.a)?t:1)).toString(16);1===a.length&&(a="0"+a),v(e.hex+a)}else v(e.hex)},disableAlpha:!n})):null)))},exports.VarDisplay=function(e){var t=e.label,l=e.disabled,n=e.className,r=s(e.path,e.value);return a.createElement(o,{label:t,disabled:l,className:n},a.createElement("span",null,r[0]))},exports.VarImage=function(e){var l=e.label,n=e.disabled,r=e.className,u=s(e.path,e.value,e.onChange),c=u[0],i=u[1],m=t.useRef(null),v=t.useCallback((function(){i({src:null}),m&&m.current&&(m.current.value="")}),[i,m]),d=t.useCallback((function(e){var t,a,l=null==e?void 0:e.target.files;if(l&&l.length){var n=l[0],r=URL.createObjectURL(n),u=null==(t=n.name.split("."))||null==(a=t.pop())?void 0:a.toLowerCase();i({src:r,type:n.type,extension:u})}}),[i]);return a.createElement(o,{label:l,disabled:n,className:r},a.createElement("div",{className:"react-var-ui-image"},a.createElement("div",{className:"react-var-ui-image-wrapper"},null==c||null==c.src?a.createElement(h,null):a.createElement("img",{className:"react-var-ui-image-wrapper-preview",src:c.src instanceof HTMLImageElement?c.src.src:c.src,alt:"preview"}),a.createElement("input",{ref:m,type:"file",id:"",onChange:d})),null==c||null==c.src?null:a.createElement("span",{className:"react-var-ui-image-delete",onClick:v},"删除")))},exports.VarNumber=function(e){var l=e.label,n=e.min,r=e.max,u=e.step,c=void 0===u?1:u,i=e.integer,m=e.showButtons,v=e.disabled,g=e.className,h=s(e.path,e.value,e.onChange),b=h[0],E=h[1],N=t.useMemo((function(){return d(b,n,r,c,!!i)}),[b,n,r,c,i]),C=t.useCallback((function(){return E(d(b+(null!=c?c:1),n,r,c,!!i))}),[b,E,i,n,r,c]),x=t.useCallback((function(){return E(d(b-(null!=c?c:1),n,r,c,!!i))}),[b,E,i,n,r,c]);return a.createElement(o,{label:l,disabled:v,className:g},a.createElement("div",{className:"react-var-ui-number"},a.createElement("input",{className:"react-var-ui-number-input",type:"number",min:n,max:r,step:c,value:N.toString(),onChange:function(e){return E(d(parseFloat(e.target.value),n,r,c,!!i))}}),m&&a.createElement(a.Fragment,null,a.createElement("button",{title:"Increase",onClick:C},a.createElement(p,null)),a.createElement("button",{title:"Decrease",onClick:x},a.createElement(f,null)))))},exports.VarSelect=function(e){var l=e.label,n=e.options,r=e.disabled,u=e.className,c=s(e.path,e.value,e.onChange),i=c[0],m=c[1],v=t.useMemo((function(){return JSON.stringify(i)}),[i]);return a.createElement(o,{label:l,disabled:r,className:u},a.createElement("div",{className:"react-var-ui-select"},a.createElement("select",{onChange:function(e){return m(JSON.parse(e.target.value))},value:v,title:"Select options"},n.map((function(e){var t,l=JSON.stringify(null!=(t=e.value)?t:e.key);return a.createElement("option",{key:e.key,value:l},e.label)})))))},exports.VarSlider=function(e){var l=e.label,n=e.path,r=e.value,c=e.onChange,i=e.min,m=e.max,v=e.step,g=e.integer,h=e.defaultValue,b=e.showInput,E=e.showButtons,N=e.disabled,C=e.className,x=t.useRef(null),k=s(n,r,c),w=k[0],y=k[1],V=t.useMemo((function(){return d(w,i,m,v,!!g)}),[w,i,m,v,g]),M=t.useMemo((function(){return(V-i)/(m-i)*100}),[V,i,m]),S=t.useCallback((function(e){if(x.current){var t=x.current.getBoundingClientRect(),a=d(i+(e-t.left)/t.width*(m-i),i,m,v,!!g);y(a)}}),[y,g,i,m,v]),D=t.useCallback((function(){return y(d(w+v,i,m,v,!!g))}),[w,y,g,i,m,v]),I=t.useCallback((function(){return y(d(w-v,i,m,v,!!g))}),[w,y,g,i,m,v]),L=u.usePointerDragSimple(S).events;return t.useEffect((function(){var e;null==(e=x.current)||e.addEventListener("wheel",(function(e){return e.preventDefault()}))}),[]),a.createElement(o,{label:l,disabled:N,className:C},a.createElement("div",{className:"react-var-ui-slider"},a.createElement("div",Object.assign({className:"react-var-ui-slider-track",ref:x,onClick:function(e){return S(e.clientX)},onDoubleClick:function(){return void 0!==h&&y(h)},onWheel:function(e){e.deltaY<0?D():I()},title:"Slider"},L),a.createElement("div",{className:"react-var-ui-slider-content",style:{width:M+"%"}})),b?a.createElement("input",{className:"react-var-ui-slider-input",type:"number",min:i,max:m,step:v,value:V,onChange:function(e){return y(d(parseFloat(e.target.value),i,m,v,!!g))}}):a.createElement("span",null,V.toString()),E&&a.createElement(a.Fragment,null,a.createElement("button",{title:"Increase",onClick:D},a.createElement(p,null)),a.createElement("button",{title:"Decrease",onClick:I},a.createElement(f,null)))))},exports.VarString=function(e){var l=e.label,n=e.maxLength,r=e.multiline,u=e.autoexpand,c=e.disabled,i=e.className,m=s(e.path,e.value,e.onChange),v=m[0],d=m[1],f=t.useMemo((function(){return u?{overflow:"hidden",resize:"none"}:void 0}),[u]);return a.createElement(o,{label:l,disabled:c,className:i},r?a.createElement("textarea",{className:"react-var-ui-string-multiline",value:v,onChange:function(e){return d(e.target.value)},onInput:u?function(e){var t=e.currentTarget;t.style.height="0",t.style.height=t.scrollHeight+"px"}:void 0,style:f}):a.createElement("span",{className:"react-var-ui-string"},a.createElement("input",{type:"text",maxLength:n,value:v,onChange:function(e){return d(e.target.value)}})))},exports.VarToggle=function(e){var t=e.label,l=e.disabled,n=e.className,r=s(e.path,e.value,e.onChange),u=r[1];return a.createElement(o,{label:t,disabled:l,className:n},a.createElement("span",null,a.createElement("label",{className:"react-var-ui-toggle",title:"Toggle"},a.createElement("input",{type:"checkbox",checked:r[0]||!1,onChange:function(e){return u(e.target.checked)}}),a.createElement("span",{className:"react-var-ui-toggle-helper"}))))},exports.VarUI=function(e){var u=e.values,c=e.updateValues,s=e.className,o=e.children,m=t.useCallback((function(e){return e?r(u,e):void 0}),[u]),v=t.useCallback((function(e,t){c(n(l(u),e,t))}),[u,c]),d=t.useMemo((function(){return{values:u,getValue:m,setValue:v}}),[u,m,v]);return a.createElement(i.Provider,{value:d},a.createElement("div",{className:"react-var-ui "+(s||"")},o))},exports.VarXY=function(e){var l=e.label,n=e.path,r=e.value,c=e.onChange,i=e.disabled,m=e.className,v=e.defaultValue,d=void 0===v?[0,0]:v,f=e.min,p=void 0===f?[-1,-1]:f,h=e.max,b=void 0===h?[1,1]:h,E=e.step,N=void 0===E?[.01,.01]:E,C=t.useRef(null),x=s(n,r,c),k=x[0],w=x[1],y=t.useMemo((function(){return g(k,p,b,N)}),[k,p,b,N]),V=t.useMemo((function(){return function(e,t,a){if(!e)return[50,50];for(var l=[0,0],n=0;n<e.length;n++)l[n]=(e[n]-t[n])/(a[n]-t[n])*100;return l}(y,p,b)}),[y,p,b]),M=t.useCallback((function(e,t){if(C.current){var a=C.current.getBoundingClientRect(),l=g([p[0]+(e-a.left)/a.width*(b[0]-p[0]),p[1]+(t-a.top)/a.height*(b[1]-p[1])],p,b,N);w(l)}}),[w,p,b,N]),S=u.usePointerDragSimple(M).events,D=t.useCallback((function(){void 0!==d&&w(d)}),[d,w]);return a.createElement(o,{label:l,disabled:i,className:m},a.createElement("span",{className:"react-var-ui-xy-value"},y[0],", ",y[1]),a.createElement("div",{className:"react-var-ui-xy"},a.createElement("div",Object.assign({className:"react-var-ui-xy-space",ref:C,onClick:function(e){return M(e.clientX,e.clientY)},onDoubleClick:D},S),a.createElement("div",{className:"react-var-ui-xy-control",style:{top:V[1]+"%",left:V[0]+"%"}}))))},exports.useVarUIValue=s;
//# sourceMappingURL=react-var-ui.cjs.production.min.js.map
